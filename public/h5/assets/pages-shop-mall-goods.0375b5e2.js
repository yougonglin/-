import{r as a,d as e,U as t,G as l,n as s,o,c as n,w as i,i as r,a as u,u as d,g as c,h as m,F as p,R as f,b as h,k as g,t as v,m as _}from"./index-dd065053.js";import{_ as b}from"./uni-section.1e3d76cc.js";import{o as y,a as k,r as j}from"./uni-app.es.ce8d824d.js";import{_ as w}from"./n-cell.b6cef899.js";import{_ as x}from"./uni-pagination.5591698a.js";import{_ as C}from"./n-picker.dfe42975.js";import{_ as z}from"./mCheckbox.08f56c9e.js";import{g as V,a as S,b as A}from"./shop.dc051026.js";import"./n-icon.66eb4db5.js";import"./uni-icons.721cc791.js";import"./system.bd116065.js";import"./request.d55298d6.js";const D={__name:"goods",setup(D){let I=a([]),J=a(1),N=a(0),O=a([]),U=a(0),q=a(!1),E=a([]),F=a("请选择分类");const G={s1:{label:"name",value:"id"},s2:{label:"name",value:"id",tag:"category"}};let L=a([]);const P=e((()=>a=>JSON.parse(a)[0]));function R(){A(J.value,U.value).then((a=>{N.value=a.data.data.c,O.value=a.data.data.result}))}function T(a){J.value=a.current,R()}function B(){q.value=!0}function H(a){a.checkValue[1]?(J.value=1,F.value=a.checkArr[1],U.value=a.checkValue[1],q.value=!1,R()):l({title:"没有选择子分类",icon:"error"})}return y((a=>{t({itemList:["添加商品","修改商品","删除商品"],success(a){switch(a.tapIndex){case 0:s({url:"/pages/shop/mall/save"});break;case 1:s({url:"/pages/shop/mall/save?id="+I.value[0]});break;case 2:V(JSON.stringify(I.value)).then((a=>{l({title:"成功删除数据："+a.data.data+"条",icon:"none"}),I.value=[],R()}))}}})})),k((a=>{S().then((a=>{E.value=a.data.data;let e=[];for(let t=0;t<a.data.data.length;t++)0==a.data.data[t].pid&&e.push(a.data.data[t]);for(let t=0;t<e.length;t++){let l=[];for(let s=0;s<a.data.data.length;s++)a.data.data[s].pid==e[t].id&&l.push(a.data.data[s]);e[t]={...e[t],category:l}}L.value=e}))})),(a,e)=>{const t=j(h("uni-section"),b),l=j(h("n-cell"),w),s=r,y=_,k=j(h("uni-pagination"),x),V=j(h("n-picker"),C);return o(),n(s,null,{default:i((()=>[u(t,{class:"mb-10",title:"商品分类","sub-title":"",type:"line"}),u(s,{class:"n-ms-ll uni-mt-5"},{default:i((()=>[u(l,{onCellClicked:B,title:d(F),bgType:"inverse",boxStyle:"padding-left:32rpx;",indicator:"arrow-right"},null,8,["title"])])),_:1}),(o(!0),c(p,null,m(d(O),((a,t)=>(o(),n(s,{class:"",key:a.id},{default:i((()=>[u(z,{modelValue:d(I),"onUpdate:modelValue":e[0]||(e[0]=a=>f(I)?I.value=a:I=a),id:a.id,isCheck:a.isCheck,title:a.goods_name,image:d(P)(a.image)},{body:i((()=>[u(s,{class:"n-flex-row n-justify-between n-ms-top-ll"},{default:i((()=>[u(y,{style:{"font-size":"24rpx"}},{default:i((()=>[g("商品ID：")])),_:1}),u(y,{style:{"font-weight":"800",color:"#ff495d","font-size":"24rpx"}},{default:i((()=>[g(v(a.id),1)])),_:2},1024)])),_:2},1024),u(s,{class:"n-flex-row n-justify-between n-ms-top-ll"},{default:i((()=>[u(y,{style:{"font-size":"24rpx"}},{default:i((()=>[g("商品价格：")])),_:1}),u(y,{style:{"font-weight":"800",color:"#ff495d","font-size":"24rpx"}},{default:i((()=>[g(v(a.price)+"元",1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["modelValue","id","isCheck","title","image"])])),_:2},1024)))),128)),u(k,{onChange:T,class:"n-ms-top-ll n-ms-bottom-ll",total:d(N),pageSize:"30"},null,8,["total"]),u(V,{title:"分类选择",show:d(q),selections:d(L),mode:"s2",labelProps:G,onCancel:e[1]||(e[1]=a=>f(q)?q.value=!1:q=!1),onConfirm:H},null,8,["show","selections"])])),_:1})}}};export{D as default};
