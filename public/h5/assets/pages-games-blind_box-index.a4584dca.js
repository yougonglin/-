import{r as e,Q as l,U as a,G as t,n as s,o as n,c as o,w as i,i as u,a as d,u as m,R as r,g as p,h as c,F as f,b,k as x,t as y,m as _}from"./index-dd065053.js";import{_ as g}from"./uni-section.1e3d76cc.js";import{a as V,o as h,r as v}from"./uni-app.es.ce8d824d.js";import{_ as j}from"./cl-upload.0a80f3fb.js";import{_ as U}from"./uni-easyinput.e534a72b.js";import{_ as k}from"./n-button.b3507bff.js";import{_ as T}from"./mCheckbox.08f56c9e.js";import{c as w}from"./request.d55298d6.js";import{b as C,a as R,c as E}from"./games.d8586acb.js";import"./uni-cloud.es.a358b7b6.js";import"./uni-icons.721cc791.js";import"./n-icon.66eb4db5.js";const z={__name:"index",setup(z){let B=e([]),L=l({data:{}}),Q=e(w.HTTP_REQUEST_URL+"/app/index/upload"),S=e([]),D=e([]);function F(e){B.value.push(w.HTTP_REQUEST_URL+"/storage/"+e.data[0])}function H(){L.data={},B.value=[]}function I(){Reflect.set(L.data,"image",B.value[0]);let e=(1e3*L.data.normal+1e3*L.data.rare+1e3*L.data.legend+1e3*L.data.explosive)/1e3;100!=e?alert("概率之和必须为100,当前为:"+e):E(L.data).then((e=>{e.data.data?(t({title:"成功添加/更新"}),P(),H()):t({title:"没有数据更新",icon:"error"})}))}function P(){R(1).then((e=>{D.value=e.data.data}))}return V((e=>{P()})),h((e=>{a({itemList:["查看盲盒","删除盲盒"],success(e){switch(e.tapIndex){case 0:s({url:"/pages/games/blind_box/goods?id="+S.value[S.value.length-1]});break;case 1:C(S.value).then((e=>{e.data.data?(t({title:"删除成功"}),P()):t({title:"没有数据更新",icon:"error"})}))}}})})),(e,l)=>{const a=v(b("uni-section"),g),t=v(b("cl-upload"),j),s=v(b("uni-easyinput"),U),V=u,h=v(b("n-button"),k),w=_;return n(),o(V,{class:""},{default:i((()=>[d(a,{class:"mb-10",title:"展示图片","sub-title":"",type:"line"}),d(t,{style:{margin:"26rpx"},imageFormData:{compress:!0},modelValue:m(B),"onUpdate:modelValue":l[0]||(l[0]=e=>r(B)?B.value=e:B=e),action:m(Q),onOnSuccess:F},null,8,["modelValue","action"]),d(a,{class:"mb-10",title:"盲盒名称","sub-title":"",type:"line"}),d(V,{class:"n-ms-ll uni-mt-5"},{default:i((()=>[d(s,{trim:"all",modelValue:m(L).data.title,"onUpdate:modelValue":l[1]||(l[1]=e=>m(L).data.title=e),placeholder:"盲盒标题,如数码盲盒"},null,8,["modelValue"])])),_:1}),d(a,{class:"mb-10",title:"盲盒价格","sub-title":"",type:"line"}),d(V,{class:"n-ms-ll uni-mt-5"},{default:i((()=>[d(s,{trim:"all",modelValue:m(L).data.price,"onUpdate:modelValue":l[2]||(l[2]=e=>m(L).data.price=e),type:"number",placeholder:"盲盒价格,如35元输入35"},null,8,["modelValue"])])),_:1}),d(a,{class:"mb-10",title:"普通概率","sub-title":"",type:"line"}),d(V,{class:"n-ms-ll uni-mt-5 n-flex-row"},{default:i((()=>[d(s,{maxlength:6,trim:"all",modelValue:m(L).data.normal,"onUpdate:modelValue":l[3]||(l[3]=e=>m(L).data.normal=e),type:"number",placeholder:"百分比概率,10%输入10,总和为100"},null,8,["modelValue"])])),_:1}),d(a,{class:"mb-10",title:"稀有概率","sub-title":"",type:"line"}),d(V,{class:"n-ms-ll uni-mt-5 n-flex-row"},{default:i((()=>[d(s,{maxlength:6,trim:"all",modelValue:m(L).data.rare,"onUpdate:modelValue":l[4]||(l[4]=e=>m(L).data.rare=e),type:"number",placeholder:"百分比概率,10%输入10,总和为100"},null,8,["modelValue"])])),_:1}),d(a,{class:"mb-10",title:"史诗概率","sub-title":"",type:"line"}),d(V,{class:"n-ms-ll uni-mt-5 n-flex-row"},{default:i((()=>[d(s,{maxlength:6,trim:"all",modelValue:m(L).data.legend,"onUpdate:modelValue":l[5]||(l[5]=e=>m(L).data.legend=e),type:"number",placeholder:"百分比概率,10%输入10,总和为100"},null,8,["modelValue"])])),_:1}),d(a,{class:"mb-10",title:"传说概率","sub-title":"",type:"line"}),d(V,{class:"n-ms-ll uni-mt-5 n-flex-row"},{default:i((()=>[d(s,{maxlength:6,trim:"all",modelValue:m(L).data.explosive,"onUpdate:modelValue":l[6]||(l[6]=e=>m(L).data.explosive=e),type:"number",placeholder:"百分比概率,10%输入10,总和为100"},null,8,["modelValue"])])),_:1}),d(V,{class:"n-ms-ll uni-mt-5 n-ps-top-ll"},{default:i((()=>[d(h,{onButtonClicked:H,bgType:"primary",textType:"inverse",border:"none",text:"清空数据(更新后必须清空ID)"})])),_:1}),d(V,{class:"n-ms-ll uni-mt-5 n-ps-top-ll"},{default:i((()=>[d(h,{onButtonClicked:I,bgType:"error",textType:"inverse",border:"none",text:"新增/更新商品"})])),_:1}),(n(!0),p(f,null,c(m(D),((e,a)=>(n(),o(V,{class:"",key:e.id},{default:i((()=>[d(T,{onClick:l=>function(e){L.data=e,B.value[0]=e.image}(e),modelValue:m(S),"onUpdate:modelValue":l[7]||(l[7]=e=>r(S)?S.value=e:S=e),id:e.id,isCheck:e.isCheck,title:e.title,image:e.image},{body:i((()=>[d(V,{class:"n-flex-row n-justify-between n-ms-top-ll"},{default:i((()=>[d(w,{style:{"font-size":"24rpx"}},{default:i((()=>[x("盲盒价格：")])),_:1}),d(w,{style:{"font-weight":"800",color:"#ff495d","font-size":"24rpx"}},{default:i((()=>[x(y(e.price)+"元",1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick","modelValue","id","isCheck","title","image"])])),_:2},1024)))),128))])),_:1})}}};export{z as default};
