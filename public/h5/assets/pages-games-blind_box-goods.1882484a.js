import{Q as t,r as e,d as a,U as l,G as i,o as s,c as n,w as o,i as d,a as u,u as r,R as m,g as c,h as p,F as f,b,k as _,t as x,m as y}from"./index-dd065053.js";import{_ as h}from"./uni-section.1e3d76cc.js";import{a as g,o as v,r as k}from"./uni-app.es.ce8d824d.js";import{_ as j}from"./uni-easyinput.e534a72b.js";import{_ as w}from"./n-check-static.bdada69e.js";import{_ as C}from"./n-button.b3507bff.js";import{_ as V}from"./uni-pagination.5591698a.js";import{_ as z}from"./mCheckbox.08f56c9e.js";import{d as B,e as U,f as F}from"./games.d8586acb.js";import"./uni-icons.721cc791.js";import"./n-icon.66eb4db5.js";import"./request.d55298d6.js";const I={__name:"goods",setup(I){let S=t({data:{}}),T=e([{title:"普通款",value:1},{title:"稀有款",value:2},{title:"史诗款",value:3},{title:"传说款",value:4}]),L=e([]),q=e(1),A=e([]),D=e([]),G=e(0);const J=a((()=>t=>{switch(t){case 1e-4:return.2;case 2e-4:return.02;default:return t}})),N=a((()=>t=>JSON.parse(t)[0]));function O(){let t=S.data.blind_box_id;S.data={},S.data.blind_box_id=t}function Q(){S.data.type=L.value[0],S.data.limit||delete S.data.limit,F(S.data).then((t=>{t.data.data?(O(),i({title:"成功添加/更新"}),H()):i({title:"没有数据更新",icon:"error"})}))}function R(){delete S.data.limit}function E(t){q.value=t.current,H()}function H(){U({page:q.value,blind_box_id:S.data.blind_box_id}).then((t=>{D.value=t.data.data.data,G.value=t.data.data.total[0].total}))}return g((t=>{S.data.blind_box_id=t.id,H()})),v((t=>{l({itemList:["删除盲盒"],success(t){if(0===t.tapIndex)B(A.value).then((t=>{t.data.data?(A.value=[],i({title:"删除成功"}),H()):i({title:"没有数据更新",icon:"error"})}))}})})),(t,e)=>{const a=k(b("uni-section"),h),l=k(b("uni-easyinput"),j),i=d,g=k(b("n-check-static"),w),v=k(b("n-button"),C),B=y,U=k(b("uni-pagination"),V);return s(),n(i,{class:""},{default:o((()=>[u(a,{class:"mb-10",title:"商品索引","sub-title":"",type:"line"}),u(i,{class:"n-ms-ll uni-mt-5"},{default:o((()=>[u(l,{trim:"all",modelValue:r(S).data.product_id,"onUpdate:modelValue":e[0]||(e[0]=t=>r(S).data.product_id=t),type:"number",placeholder:"指定商品索引"},null,8,["modelValue"])])),_:1}),u(a,{class:"mb-10",title:"概率类型","sub-title":"",type:"line"}),u(i,{class:"n-ms-ll uni-mt-5 n-flex-row"},{default:o((()=>[u(g,{onChange:R,valueLabel:"value",limits:1,textLabel:"title",value:r(L),"onUpdate:value":e[1]||(e[1]=t=>m(L)?L.value=t:L=t),icon:"circle",checkedIcon:"check-solid",items:r(T),direction:"right",isBetween:!0,itemBoxStyle:"background-color:#F5F7F9;padding-left:32rpx;padding-right:32rpx;",boxStyle:"border-radius:16rpx;overflow:hidden;flex:1;"},null,8,["value","items"])])),_:1}),u(a,{class:"mb-10",title:"商品概率","sub-title":"",type:"line"}),u(i,{class:"n-ms-ll uni-mt-5 n-flex-row"},{default:o((()=>[u(l,{trim:"all",modelValue:r(S).data.limit,"onUpdate:modelValue":e[2]||(e[2]=t=>r(S).data.limit=t),type:"number",placeholder:"自定义商品中奖概率"},null,8,["modelValue"])])),_:1}),u(i,{class:"n-ms-ll uni-mt-5 n-ps-top-ll"},{default:o((()=>[u(v,{onButtonClicked:O,bgType:"primary",textType:"inverse",border:"none",text:"清空数据(更新后必须清空ID)"})])),_:1}),u(i,{class:"n-ms-ll uni-mt-5 n-ps-top-ll"},{default:o((()=>[u(v,{onButtonClicked:Q,bgType:"error",textType:"inverse",border:"none",text:"新增/更新商品"})])),_:1}),(s(!0),c(f,null,p(r(D),((t,a)=>(s(),n(i,{class:"",key:t.id},{default:o((()=>[u(z,{onClick:e=>function(t){S.data.product_id=t.product_id,L.value[0]=parseInt(t.type),S.data.limit=t.probability,S.data.id=t.id}(t),modelValue:r(A),"onUpdate:modelValue":e[3]||(e[3]=t=>m(A)?A.value=t:A=t),id:t.id,isCheck:t.isCheck,title:t.goods_name,image:r(N)(t.image)},{body:o((()=>[u(i,{class:"n-flex-row n-justify-between n-ms-top-ll"},{default:o((()=>[u(B,{style:{"font-size":"24rpx"}},{default:o((()=>[_("商品价格：")])),_:1}),u(B,{style:{"font-weight":"800",color:"#ff495d","font-size":"24rpx"}},{default:o((()=>[_(x(t.price)+"元",1)])),_:2},1024)])),_:2},1024),u(i,{class:"n-flex-row n-justify-between n-ms-top-ll"},{default:o((()=>[u(B,{style:{"font-size":"24rpx"}},{default:o((()=>[_("中奖概率：")])),_:1}),u(B,{style:{"font-weight":"800",color:"#ff495d","font-size":"24rpx"}},{default:o((()=>[_(x(r(J)(t.probability))+"%",1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick","modelValue","id","isCheck","title","image"])])),_:2},1024)))),128)),u(U,{onChange:E,class:"n-ms-top-ll n-ms-bottom-ll",total:r(G),pageSize:"30"},null,8,["total"])])),_:1})}}};export{I as default};
